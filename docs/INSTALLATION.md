# Installation Guide

This guide provides detailed setup instructions for Roslyn MCP with Claude Code.

## Prerequisites

Before installing Roslyn MCP, ensure you have:

- **Node.js 18+** and **npm** - [Download Node.js](https://nodejs.org/)
- **.NET 8.0+ SDK** - [Download .NET](https://dotnet.microsoft.com/download)
- **Claude Code** - [Get Claude Code](https://claude.ai/code)

## Installation Steps

### 1. Clone and Build

```bash
# Clone the repository
git clone https://github.com/Saqoosha/roslyn-mcp.git
cd roslyn-mcp

# Install dependencies
npm install

# Build the project
npm run build
```

### 2. Verify Installation

```bash
# Test the CLI
node dist/cli.js --help

# Verify .NET is available
dotnet --version
```

### 3. Configure Claude Code

Create or edit your Claude Code MCP configuration file (`.mcp.json`):

```json
{
  "mcpServers": {
    "roslyn-lsp": {
      "command": "node",
      "args": ["/path/to/roslyn-mcp/dist/cli.js", "/path/to/your/csharp/project"],
      "env": {
        "PROJECT_ROOT": "/path/to/your/csharp/project"
      }
    }
  }
}
```

**Important**: Replace `/path/to/roslyn-mcp` with the actual path to your cloned repository.

## Configuration Options

### Basic Configuration

For small to medium C# projects:

```json
{
  "mcpServers": {
    "roslyn-lsp": {
      "command": "node",
      "args": ["/path/to/roslyn-mcp/dist/cli.js", "/path/to/your/project"],
      "env": {
        "PROJECT_ROOT": "/path/to/your/project"
      }
    }
  }
}
```

### Unity Project Configuration

For Unity projects, use fast-start mode for better performance:

```json
{
  "mcpServers": {
    "roslyn-lsp": {
      "command": "node",
      "args": [
        "/path/to/roslyn-mcp/dist/cli.js",
        "--fast-start",
        "/path/to/your/unity/project"
      ],
      "env": {
        "PROJECT_ROOT": "/path/to/your/unity/project"
      }
    }
  }
}
```

### Large Project Configuration

For enterprise or complex projects with long initialization times:

```json
{
  "mcpServers": {
    "roslyn-lsp": {
      "command": "node",
      "args": [
        "/path/to/roslyn-mcp/dist/cli.js",
        "--fast-start",
        "--timeout", "180000",
        "/path/to/your/project"
      ],
      "env": {
        "PROJECT_ROOT": "/path/to/your/project"
      }
    }
  }
}
```

## Environment Variables

### Required Variables

- **`PROJECT_ROOT`**: Path to your C# project or solution directory

### Optional Variables

- **`DOTNET_ROOT`**: Path to .NET installation (auto-detected if not specified)
- **`ROSLYN_LSP_PATH`**: Custom path to Roslyn LSP binaries (uses bundled version if not specified)

### Example with Custom Variables

```json
{
  "mcpServers": {
    "roslyn-lsp": {
      "command": "node",
      "args": ["/path/to/roslyn-mcp/dist/cli.js", "/path/to/your/project"],
      "env": {
        "PROJECT_ROOT": "/path/to/your/project",
        "DOTNET_ROOT": "/usr/local/share/dotnet",
        "ROSLYN_LSP_PATH": "/custom/path/to/roslyn"
      }
    }
  }
}
```

## Command Line Options

### Available Options

- **`--fast-start`**: Enable fast-start mode for large projects
- **`--timeout <ms>`**: Set initialization timeout in milliseconds
- **`--help`**: Show help information
- **`--version`**: Show version information

### Examples

```bash
# Regular mode
node dist/cli.js /path/to/project

# Fast-start mode
node dist/cli.js --fast-start /path/to/project

# Custom timeout
node dist/cli.js --fast-start --timeout 300000 /path/to/project
```

## Project Structure Requirements

### C# Console Applications

Your project should have:
- A `.csproj` file or `.sln` solution file
- Valid C# source files (`.cs`)
- Proper NuGet package references (if any)

### Unity Projects

Your Unity project should have:
- A `.sln` solution file (generated by Unity)
- Assembly definition files (`.asmdef`) if using custom assemblies
- Proper Unity package references

### Example Project Structure

```
MyProject/
├── MyProject.sln          # Solution file
├── MyProject.csproj       # Project file
├── Program.cs             # C# source files
├── Models/
│   └── User.cs
└── bin/                   # Build output (auto-generated)
```

## Verification

### 1. Test Claude Code Connection

Open Claude Code and try:
```
"Check if Roslyn MCP is working"
```

You should see tools like `lsp_get_diagnostics` being used.

### 2. Test Basic Functionality

```
"What C# files are in my project?"
→ Uses lsp_get_workspace_symbols

"Check for errors in Program.cs"
→ Uses lsp_get_diagnostics
```

### 3. Verify Unity Support (if applicable)

```
"Find all MonoBehaviour classes"
→ Uses lsp_get_workspace_symbols with Unity context

"Check Unity.Logging usage"
→ Uses lsp_get_diagnostics with Unity assemblies
```

## Troubleshooting

### Common Issues

#### "Command not found" or "Module not found"

- Ensure Node.js and npm are properly installed
- Verify the path to `dist/cli.js` is correct
- Run `npm run build` to ensure the project is built

#### "No symbols found" or "Empty workspace"

- Ensure `PROJECT_ROOT` points to the correct directory
- Check that your project has a `.csproj` or `.sln` file
- Allow 5-10 seconds for workspace indexing after startup

#### ".NET not found" errors

- Ensure .NET SDK is installed: `dotnet --version`
- Check `DOTNET_ROOT` environment variable if using custom installation
- Verify your project targets a supported .NET version

#### Unity-specific issues

- Ensure Unity has generated the solution file (`.sln`)
- Check that Unity project compiles without errors
- Verify Unity package references are properly configured

### Getting Help

If you encounter issues:

1. Check the Claude Code logs for detailed error messages
2. Verify your configuration matches the examples above
3. Test with a simple C# project first
4. Refer to the [Troubleshooting Guide](TROUBLESHOOTING.md) for more solutions

## Next Steps

- [API Reference](API.md) - Learn about available tools
- [Examples](EXAMPLES.md) - See usage examples
- [Claude Code Integration](CLAUDE.md) - Claude Code specific features

## Development Setup

If you want to contribute or modify Roslyn MCP:

```bash
# Install development dependencies
npm install

# Run in development mode
npm run dev

# Run tests
npm run test

# Build for production
npm run build
```

For more development information, see the [Contributing Guide](../CONTRIBUTING.md).